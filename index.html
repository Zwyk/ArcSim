<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ARC Raiders — TTK Simulator</title>
  <link rel="icon" type="image/png" href="Rubber_Duck.png" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="titleRow">
          <div class="title">ARC Raiders</div>
          <button id="infoBtn" class="ghost iconBtn" type="button" title="Information">i</button>
        </div>
        <div class="subtitle">TTK Simulator</div>
      </div>

      <div class="panel">
        <label class="label">Preset</label>
        <select id="presetSelect"></select>

        <label class="label">Target</label>
        <select id="targetSelect"></select>

        <label class="label">Tiers</label>
        <div id="tierChecks" class="tierChecks"></div>

        <label class="check">
          <input id="baseOnly" type="checkbox" checked />
          Base only (no attachments)
        </label>

        
      </div>

      <div class="panel">
        <div class="panelTitle">Custom preset (simulated)</div>

        <!-- Removed custom enable checkbox; custom simulation always available -->

        <div class="row2">
          <div>
            <label class="label">Head %</label>
            <input id="headPct" type="range" min="0" max="100" value="10" />
          </div>
          <div>
            <label class="label">Limbs %</label>
            <input id="limbsPct" type="range" min="0" max="100" value="20" />
          </div>
        </div>
        <div class="hint" id="bodyLabel">Body: 70%, Head: 10%, Limbs: 20%</div>

        <label class="label">Miss %</label>
        <input id="missPct" type="range" min="0" max="95" value="5" />
        <div class="hint" id="missLabel">Miss: 5%</div>

        <div class="row2">
          <div>
            <label class="label">Trials</label>
            <input id="trials" type="number" min="100" step="100" value="1000" />
          </div>
          <div>
            <label class="label">Seed</label>
            <input id="seed" type="number" min="0" step="1" value="1337" />
          </div>
          <div>
            <label class="label">CI</label>
            <select id="confidence">
              <option value="0.90">90%</option>
              <option value="0.95" selected>95%</option>
              <option value="0.99">99%</option>
            </select>
          </div>
        </div>

        <button id="runBtn">Start simulation</button>
        <div class="hint" id="status"></div>
        <div style="display:flex; align-items:center; gap:8px; margin-top:8px;">
          <button id="editWeaponsBtn" class="ghost" type="button">Edit values</button>
          <span id="weaponsOverrideCue" class="hint" style="display:none;">Override active</span>
        </div>

        <button id="downloadBtn" class="ghost" disabled>Download current rows (.json)</button>
      </div>
    </aside>
    <div id="sidebarBackdrop" class="sidebarBackdrop" aria-hidden="true"></div>

    <main class="main">
      <div class="header">
        <div class="headerLeft">
          <button id="sidebarToggleBtn" class="ghost iconBtn sidebarToggle" type="button" title="Menu">☰</button>
          <div>
            <div class="h1" id="heading">Fastest setups</div>
            <div class="hint" id="subheading"></div>
          </div>
        </div>
        <div class="stats">
          <div class="stat"><div class="k" id="rowsCount">0</div><div class="v">rows</div></div>
          <div class="stat"><div class="k" id="weaponsCount">0</div><div class="v">weapons</div></div>
        </div>
      </div>

      <div class="tableWrap">
        <div class="chartGlobalControls">
          <label class="chartCtl">
            <span>Metric</span>
            <select id="graphMetric">
              <option value="ttk">TTK</option>
              <option value="shots">Shots</option>
              <option value="fire_time">Fire time</option>
              <option value="reloads">Reloads</option>
              <option value="reload_time">Reload time</option>
            </select>
          </label>

          <label class="chartCtl">
            <span>Order by</span>
            <select id="graphOrderBy">
              <option value="ttk">TTK</option>
              <option value="shots">Shots</option>
              <option value="fire_time">Fire time</option>
              <option value="reloads">Reloads</option>
              <option value="reload_time">Reload time</option>
            </select>
          </label>
        </div>
        <div class="card chartCard">
          <div class="chartHeader">
            <div>
              <div class="chartTitle">Weapons graph</div>
              <div class="chartMeta" id="chartMeta"></div>
              <div class="chartControls chartControlsLeft">
                <label class="chartCtl">
                  <span>Tier merge tolerance (s)</span>
                      <input id="tierTtkTol"
                         class="chartScaleInput"
                         type="number"
                         min="0"
                         step="0.001"
                        value="0.001"
                        placeholder="0.001">
                </label>

                <label class="chartCtl chartCtlInline">
                  <span>TTK includes reload</span>
                  <input id="ttkIncludesReload" type="checkbox" checked>
                </label>
              </div>
            </div>

            <div class="chartControls">
              <label class="chartCtl">
                <span>Max scale (s)</span>
                <input id="ttkScaleMax" class="chartScaleInput" type="number" min="0" step="0.01" placeholder="auto">
              </label>
            </div>
          </div>

          <div class="chartWrap">
            <canvas id="ttkChart"></canvas>
            <div id="chartTooltip" class="chartTooltip" style="display:none;"></div>
          </div>
        </div>

        <div class="card chartCard" id="compareCard" style="display:none;">
          <div class="chartHeader">
            <div>
              <div class="chartTitle">Weapon comparison</div>
              <div class="chartMeta" id="compareMeta"></div>
              <div class="chartControls">
              <label class="chartCtl">
                <span>Weapon</span>
                <select id="compareWeapon"></select>
              </label>

              <label class="chartCtl">
                <span>Compare by</span>
                <select id="compareMode">
                  <option value="tier">Tier</option>
                  <option value="attachments">Attachments</option>
                </select>
              </label>

              <label class="chartCtl" id="compareTierValuesCtl" style="display:none;">
                <span>Values</span>
                <select id="compareTierValues">
                  <option value="best" selected>With best Attachments</option>
                  <option value="base">Base Only</option>
                </select>
              </label>

              <label class="chartCtl" id="compareTierCtl" style="display:none;">
                <span>Tier</span>
                <select id="compareTier"></select>
              </label>
              </div>
            </div>

            <div class="chartControls">
              <label class="chartCtl">
                <span>Max scale (s)</span>
                <input id="compareScaleMax" class="chartScaleInput" type="number" min="0" step="0.01" placeholder="auto">
              </label>
            </div>
          </div>

          <div class="chartWrap">
            <canvas id="compareChart"></canvas>
            <div id="compareTooltip" class="chartTooltip" style="display:none;"></div>
          </div>
        </div>

        <div style="display:flex; align-items:center; gap:16px; flex-wrap:wrap; margin:8px 0;">
          <label class="chartCtl">
            <span>Table values</span>
            <select id="tableCenter">
              <option value="mean" selected>Mean</option>
              <option value="median">Median</option>
            </select>
          </label>

          <label class="chartCtl">
            <span>Attachments merge tolerance (s)</span>
            <input id="stackTol" class="chartScaleInput" type="number" min="0" step="0.0001" value="0.001" placeholder="0.001">
          </label>
        </div>

        <div class="tableHint">Swipe horizontally to see more →</div>
        <div class="tableScroller">
          <table>
            <thead>
              <tr>
                <th class="sortable" data-sort="weapon">weapon</th>
                <th class="sortable num" data-sort="tier">tier</th>
                <th class="sortable" data-sort="attachments">attachments</th>
                <th class="sortable num" data-sort="ttk">ttk</th>
                <th class="sortable num" data-sort="shots">shots</th>
                <th class="sortable num" data-sort="fire_time">fire time</th>
                <th class="sortable num" data-sort="reloads">reloads</th>
                <th class="sortable num" data-sort="reload_time">reload time</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <div id="modal" class="modal hidden">
    <div class="modalBox">
      <div class="modalTitle">Variants</div>
      <div id="modalBody" class="modalBody"></div>
      <button id="modalClose" class="ghost">Close</button>
    </div>
  </div>

  <!-- Info modal -->
  <div id="infoModal" class="modal hidden" style="display:none;">
    <div class="modalBox">
      <div class="modalTitle">Information</div>
      <div class="modalBody">
<h3>Important notes</h3>
We assume optimal range for all weapons (no damage drop-off).
Aim/ADS time are not accounted for.
For guns that shoot semi-automatically, unless specified, we assume the maximum between their allowed shots per second or a good human-like clicking speed arbitrary defined to 8.0.

Some weapons stats may be inaccurate (legendary weapons in particular), most notably the fire rates and the reload times. I'll update them according to the most reliable information I find. If you have that, you can hit me on Discord: Zwyk.
You can also see and edit them temporarily by pressing the "edit values" button down there before running a custom simulation if you want to mess around or test custom values.

<h3>Patch note</h3>
2026-01-03
    - Fixed Renegade bullet-per-bullet reload and tier bonus fire rate values
    - Refined Aphelion values (2 bullets per shot, higher reload time, higher fire rate)

2025-12-17
    - Added multiple RPS display for Kettle for easier comparison
    - Added rounding to HP to fix wrong STK calculated. Affected Rattler vs Light Shield  

2025-12-16
    - Added "TTK includes reload" option to the UI
    - 1.7.0 patch: Increased mag size for Bettina and Rattler by 2, reduced reload time for Bettina to 4.5s
    - Fixed mag size for Aphelion and Vulcano
    - Fixed calculated reload time issue

2025-12-15
    - Added json values override to Shields and Attachments 
    - Fixed values in Weapons (Anvil Splitter) and Shields (Light, Heavy)
    - Fixed damage to shield calculation (was applying the body part mod)

2025-12-14
    - Improvements to the UI, including mobile support
    - Added burst firing support to Arpeggio (was steady fire rate)
    - Added multiple bullets per shot support (Shotguns, Anvil Splitter, Venator)
    - Adjusted values in Weapons to account for the new support

2025-12-09: 
    - Initial release
      </div>
      <div style="margin-top:12px; display:flex; justify-content:flex-end;">
        <button id="closeInfoModal" class="ghost" type="button">Close</button>
      </div>
    </div>
  </div>

  <!-- Weapons editor modal -->
  <div id="weaponsModal" class="modal hidden" style="display:none;">
    <div class="modalBox" style="max-width: 980px; width: 96%; padding: 18px;">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
        <div>
          <div style="font-size:16px; font-weight:650;">Edit values (session only)</div>
          <div style="font-size:12px; opacity:.75;">Used only for custom simulations. Refreshing the page resets unless you export/import.</div>
        </div>
        <div style="display:flex; align-items:center; gap:8px; flex-wrap:wrap;">
          <label style="display:flex; align-items:center; gap:8px; font-size:12px;">
            <span>File</span>
            <select id="valuesFileSelect" style="padding:6px 10px; border-radius:10px; background:var(--panel2); border:1px solid var(--border); color:var(--text);">
              <option value="weapons">weapons.json</option>
              <option value="shields">shields.json</option>
              <option value="attachments">attachments.json</option>
            </select>
          </label>
          <button id="validateWeaponsBtn" class="btn secondary" type="button">Validate</button>
          <button id="saveWeaponsBtn" class="btn" type="button">Save override</button>
          <button id="closeWeaponsModal" class="btn secondary" type="button">Close</button>
        </div>
      </div>

      <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
        <button id="resetWeaponsOverride" class="btn secondary" type="button">Reset override</button>
        <button id="downloadWeaponsOverride" class="btn secondary" type="button">Download JSON</button>
        <input id="importWeaponsOverride" type="file" accept="application/json" style="display:none;">
        <button id="importWeaponsBtn" class="btn secondary" type="button">Import JSON…</button>
        <div id="weaponsModalStatus" style="font-size:12px; opacity:.8; margin-left:auto;"></div>
      </div>

      <textarea id="weaponsEditor"
        spellcheck="false"
        style="margin-top:12px; width:100%; height:60vh; resize:vertical; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size:12px; line-height:1.4; background:rgba(0,0,0,.25); color:inherit; border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:12px;"></textarea>

      
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
